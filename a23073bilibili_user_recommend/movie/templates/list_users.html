<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>用户详情</title>

    <!-- Bootstrap core CSS -->
    <style type="text/css">
#tbl_div div {
  visibility:hidden;
    display:none;
}

div[name*="title"] {
/*  background: #ffff00;*/
  font-weight: bold;
  font-size: 150%;
  text-align: center;
}

div[class*="release_year"] {
/*  background: #ffff00;*/
  color:blue;
  font-weight: bold;
  font-size: 90%;
  text-align: center;
}



    </style>
    <link rel='stylesheet' href='/static/bootstrap-4.5.2-dist/css/bootstrap.min.css'>

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

  </head>

<bddy>

<nav class="navbar navbar-expand-lg navbar-dark bg-dark">

  <button class="navbar-toggler" type="button" data-toggle="collapse" 
  data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  <div class="collapse navbar-collapse" id="navbarSupportedContent">
    <ul class="navbar-nav mr-auto">
      <li class="nav-item active">

     <a class="nav-link" href="/home/1">Home <span class="sr-only">(current)</span></a>


      </li>

      <li class="nav-item active">
        <form class="form-inline my-2 my-lg-0 navbar-right" action="/home" method="POST">

                <div class="form-group">
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                  <input type="text" name="keyword" placeholder="search" class="form-control" autofocus>&nbsp;
                </div>
          
              <input type="submit" value="Search" class="btn btn-success">
        </form>
      </li>

      <li class="nav-item active">

      </li>


    </ul>

  </div>
</nav>



<!-- <h3><a href="/home">< home</a></h3> -->
<h1>用户管理列表</h1>
<!-- Jinja模板语法 -->

<h5><a href="/users/create">添加用户</a></h5>

<hr/>
<!-- {% if users %}
    {% for user in users%}
        <h4><a href="/users/{{user.id}}">{{user.username}} | {{user.nickname}}</a></h4>
        

    {% endfor %}
{% else %}
    <p>no doc, let's create doc~</p>
    <a href="/users/create">to create doc</a>
{% endif %} -->


{% if users %}
<table style='table-layout:fixed;'  class="StandardTable" cellpadding="0" cellspacing="0" width="100%" border="1">
    <thead>
        <tr>

            <th>email/phone</th>
            <th>姓名</th>
            <th>部门</th>
            <th>角色</th>

            <th>操作</th>
        <tr>
    </thead>
 {% for user in users%}
    <tbody>
          
        <tr>


            <td>{{ user.username|safe }}</td>
             <td> <br/>{{ user.nickname|safe  }} <br/></td>
             <td> <br/>{{ user.school_class|safe  }} <br/></td>
             <td> <br/>{{ user.role|safe  }} <br/></td>

             <td> 
                &nbsp;
            <button type="button" class="btn btn-primary">

             <a href="/users/{{user.id}}" style="color:inherit">查看 </a>
            </button>
            &nbsp;

            <button type="button" class="btn btn-warning">

             <a href="/profiles/update/{{user.id}}" style="color:inherit">修改 </a>
            </button>
            &nbsp;

            <button type="button" class="btn btn-danger">

             <a href="" class="btn-delete" id="{{user.id}}">删除</a>
            </button>
              </td>

        </tr>

    </tbody>
     {% endfor %}
</table>

{% else %}
    <p>no doc, let's create doc~</p>
    <a href="/users/create">to create doc</a>
{% endif %}


<script src="/static/jquery-3.5.1.min.js"></script>
<script src="/static/bootstrap-4.5.2-dist/js/bootstrap.min.js"></script>
<script type="text/javascript">

    $('a.btn-delete').on('click',function(evt){
        // 通知浏览器不要执行与事件关联的默认动作
        evt.preventDefault();
        // 获取课程ID
        var blogid = $(this).attr('id');
        $.ajax({
            // 请求URL
            url: "/users/" + blogid,
            // 请求方法类型
            type: "DELETE",
            contentType:"application/json",
            // 删除成功响应函数
            success:function(resp){
                // 在当前页面打开课程列表页面
                window.open("/users","_self");
            },
            // 删除失败响应函数
            error:function(resp){
                // 删除失败，给出错误提示
                alert("delete doc fail！详情：" + resp.message);
            }
        })
    });


</script>
  </body>
</html>